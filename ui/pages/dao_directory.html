<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="au theme template">
    <meta name="author" content="Hau Nguyen">
    <meta name="keywords" content="au theme template">

    <!-- Title Page-->
    <title>DAO Atheneum - Directory</title>

    <!-- Fontfaces CSS-->
    <link href="../css/font-face.css" rel="stylesheet" media="all">
    <link href="../vendor/font-awesome-5/css/fontawesome-all.min.css" rel="stylesheet" media="all">
    <link href="../vendor/font-awesome-4.7/css/font-awesome.min.css" rel="stylesheet" media="all">
    <link href="../vendor/mdi-font/css/material-design-iconic-font.min.css" rel="stylesheet" media="all">

    <!-- Bootstrap CSS-->
    <link href="../vendor/bootstrap-4.1/bootstrap.min.css" rel="stylesheet" media="all">

    <!-- Vendor CSS-->
    <link href="../vendor/animsition/animsition.min.css" rel="stylesheet" media="all">
    <link href="../vendor/bootstrap-progressbar/bootstrap-progressbar-3.3.4.min.css" rel="stylesheet" media="all">
    <link href="../vendor/wow/animate.css" rel="stylesheet" media="all">
    <link href="../vendor/css-hamburgers/hamburgers.min.css" rel="stylesheet" media="all">
    <link href="../vendor/slick/slick.css" rel="stylesheet" media="all">
    <link href="../vendor/select2/select2.min.css" rel="stylesheet" media="all">
    <link href="../vendor/perfect-scrollbar/perfect-scrollbar.css" rel="stylesheet" media="all">

    <script src="https://unpkg.com/ipfs-http-client-lite/dist/index.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script src="https://cdn.ethers.io/lib/ethers-5.0.umd.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/ethjs@0.3.4/dist/ethjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>

    <!-- Main CSS-->
    <link href="../css/theme.css" rel="stylesheet" media="all">

</head>

<body class="animsition">
    <div class="page-wrapper">
        <!-- HEADER MOBILE-->
        <header class="header-mobile d-block d-lg-none">
            <div class="header-mobile__bar">
                <div class="container-fluid">
                    <div class="header-mobile-inner">
                        <a class="logo" href="../index.html">
                            <img src="../images/icon/logo.png" alt="DAO Atheneum" />
                        </a>
                        <button class="hamburger hamburger--slider" type="button">
                            <span class="hamburger-box">
                                <span class="hamburger-inner"></span>
                            </span>
                        </button>
                    </div>
                </div>
            </div>
            <nav class="navbar-mobile">
                <div class="container-fluid">
                    <ul class="navbar-mobile__list list-unstyled">
                        <li class="has-sub">
                            <a class="js-arrow" href="../index.html">
                                <i class="fas fa-tachometer-alt"></i>DAO Media</a>
                        </li>
                        <li>
                            <a href="upload.html">
                                <i class="fas fa-upload"></i>DAO Media Upload</a>
                        </li>
                        <li>
                            <a href="atheneum.html">
                                <i class="fas fa-file-archive"></i>Atheneum</a>
                        </li>
                        <li>
                            <a href="register_dao.html">
                                <i class="fas fa-registered"></i>Register DAO</a>
                        </li>
                    </ul>
                </div>
            </nav>
        </header>
        <!-- END HEADER MOBILE-->

        <!-- MENU SIDEBAR-->
        <aside class="menu-sidebar d-none d-lg-block">
            <div class="logo">
                <a href="#">
                    <img src="../images/icon/logo.png" alt="Cool Admin" />
                </a>
            </div>
            <div class="menu-sidebar__content js-scrollbar1">
                <nav class="navbar-sidebar">
                    <ul class="list-unstyled navbar__list">
                        <li class="active has-sub">
                            <a class="js-arrow" href="../index.html">
                                <i class="fas fa-tachometer-alt"></i>DAO Media</a>
                        </li>
                        <li>
                            <a href="upload.html">
                                <i class="fas fa-upload"></i>DAO Media Upload</a>
                        </li>
                        <li>
                            <a href="atheneum.html">
                                <i class="fas fa-file-archive"></i>Atheneum</a>
                        </li>
                        <li>
                            <a href="dao_directory.html">
                                <i class="fas fa-dot-circle-o"></i>DAO Directory</a>
                        </li>

                    </ul>
                </nav>
            </div>
        </aside>
        <!-- END MENU SIDEBAR-->

        <!-- PAGE CONTAINER-->
        <div class="page-container">
            <!-- HEADER DESKTOP-->
            <header class="header-desktop">
                <div class="section__content section__content--p30">
                    <div class="container-fluid">
                        <div class="header-wrap">

                            <div class="header-button">

                                <div class="account-wrap">
                                    <div class="account-item clearfix js-item-menu">
                                        <div class="content">
                                            <button id="connect_web_3" class="au-btn au-btn-icon au-btn--blue"> <i class="zmdi zmdi-account-circle"></i>Connect Web 3</button>
                                            <span id="show_wallet"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </header>
            <!-- HEADER DESKTOP-->

            <!-- MAIN CONTENT-->
            <div class="main-content">
                <div class="section__content section__content--p30">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="card">
                                    <div class="card-header">DAO Directory</div>
                                    <div class="card-body">
                                        <div class="card-title">
                                            <h3 class="text-center title-2">Register Your DAO</h3>
                                            <small>You must ensure that you have the appropriate permissions to register your DAO</small>
                                            <span id="show_register_message"></span>
                                        </div>
                                        <hr>
                                        <form action="" method="post" novalidate="novalidate">
                                            <div class="form-group">
                                                <label for="dao_name" class="control-label mb-1">Name of DAO</label>
                                                <input id="dao_name" type="text" class="form-control" aria-required="true" aria-invalid="false">
                                            </div>
                                            <div class="form-group">
                                                <label for="dao_type" class="control-label mb-1">DAO Type</label>
                                                <input id="dao_type" type="text" class="form-control" aria-required="true" aria-invalid="false">
                                            </div>
                                            <div class="form-group">
                                                <label for="dao_short_description" class="control-label mb-1">DAO Short Description</label>
                                                <input id="dao_short_description" type="text" class="form-control" aria-required="true" aria-invalid="false">
                                            </div>
                                            <div class="row form-group">
                                                <div class="col-12 col-md-12">
                                                    <label for="dao_detailed_description" class=" form-control-label">DAO Detailed Description</label>
                                                    <textarea id="dao_detailed_description" rows="9" placeholder="What does your DAO do?" class="form-control"></textarea>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label for="member_access_type" class="control-label mb-1">DAO Member Access Type</label>
                                                <select id="member_access_type" class="form-control">
                                                    <option value="nft">NFT</option>
                                                    <option value="cryptocurrency">Cryptocurrency</option>
                                                </select>
                                            </div>

                                            <div class="form-group">
                                                <label for="access_contract" class="control-label mb-1">DAO Member Access EVM Contract</label>&nbsp;<small>Contract that we use to control access to your media</small>
                                                <input id="access_contract" type="text" class="form-control" aria-required="true" aria-invalid="false" placeholder="0x...">
                                            </div>

                                            <div class="form-group">
                                                <label for="paid_media_price" class="control-label mb-1">Paid Media Price</label>
                                                <input id="paid_media_price" type="text" class="form-control" aria-required="true" aria-invalid="false" placeholder="0.00">
                                            </div>
                                            <div class="form-group">
                                                <label for="paid_media_currency" class="control-label mb-1">Paid Media Currency</label>&nbsp;<small>Currency users must use to get access to your media</small>
                                                <input id="paid_media_currency" type="text" class="form-control" aria-required="true" aria-invalid="false" placeholder="0x...">
                                            </div>
                                            <div class="form-group">
                                                <label for="dao_wallet" class="control-label mb-1">DAO Wallet</label>&nbsp;<small>Where we send your payments to</small>
                                                <input id="dao_wallet" type="text" class="form-control" aria-required="true" aria-invalid="false" placeholder="0x...">
                                            </div>
                                            <div>
                                                <button id="register_dao_button" type="submit" class="btn btn-lg btn-info btn-block">
                                                    <i class="fa fa-registered fa-lg"></i>&nbsp;
                                                    <span>Register DAO</span>                                                    
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <div class="card">
                                    <div class="card-header">
                                        <strong>Find DAO</strong>

                                    </div>
                                    <div class="card-body card-block">
                                        <div class="row form-group">
                                            <div class="col col-md-12">
                                                <div class="input-group">
                                                    <div class="input-group-btn">
                                                        <button id="find_dao_button" class="btn btn-primary"><i class="fa fa-search"></i> Search </button>
                                                    </div>
                                                    <input type="text" id="find_dao_field" name="input1-group2" placeholder="enter name of DAO" class="form-control">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row m-t-30">
                                            <div class="col-md-12">
                                                <!-- DATA TABLE-->
                                                <div class="table-responsive m-b-40">
                                                    <table class="table table-borderless table-data3">
                                                        <thead>
                                                            <tr>
                                                                <th>DAO</th>
                                                                <th>Type</th>
                                                                <th>Description</th>
                                                                <th>Media Count</th>
                                                                <th>Media Price</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody id="dao_results">

                                                        </tbody>
                                                    </table>
                                                </div>
                                                <!-- END DATA TABLE-->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="copyright">
                                    <p>Copyright Â© 2022 Block Star Logic. All rights reserved. Template by <a href="https://colorlib.com">Colorlib</a>.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- Jquery JS-->
    <script src="../vendor/jquery-3.2.1.min.js"></script>
    <!-- Bootstrap JS-->
    <script src="../vendor/bootstrap-4.1/popper.min.js"></script>
    <script src="../vendor/bootstrap-4.1/bootstrap.min.js"></script>
    <!-- Vendor JS       -->
    <script src="../vendor/slick/slick.min.js">
    </script>
    <script src="../vendor/wow/wow.min.js"></script>
    <script src="../vendor/animsition/animsition.min.js"></script>
    <script src="../vendor/bootstrap-progressbar/bootstrap-progressbar.min.js">
    </script>
    <script src="../vendor/counter-up/jquery.waypoints.min.js"></script>
    <script src="../vendor/counter-up/jquery.counterup.min.js">
    </script>
    <script src="../vendor/circle-progress/circle-progress.min.js"></script>
    <script src="../vendor/perfect-scrollbar/perfect-scrollbar.js"></script>
    <script src="../vendor/chartjs/Chart.bundle.min.js"></script>
    <script src="../vendor/select2/select2.min.js">
    </script>

    <!-- Main JS-->
    <script src="../js/main.js"></script>
    <script src="../js/i_dao_atheneum_abi.js"></script>
    <script src="../js/dao_atheneum_connect.js"></script>
    <script>
        const registerDAOButton = ge("register_dao_button");
        registerDAOButton.addEventListener('click', registerDAO);

        const findDAOButton = ge("find_dao_button");
        findDAOButton.addEventListener('click', findDAO);

        function loadPage() {
            console.log("page loaded");
        }

        function registerDAO() {
            var dao = {};
            dao.name = ge("dao_name").value
            dao.daoType = ge("dao_type").value;
            dao.shortDescription = ge("dao_short_description").value;
            dao.detailedDescription = ge("dao_detailed_description").value;
            dao.memberAccessType = ge("member_access_type").value;
            dao.accessContract = ge("access_contract").value;
            dao.paidMediaPrice = ge("paid_media_price").value * 1e18;
            dao.paymentCurrency = ge("paid_media_currency").value;
            dao.paymentWallet = ge("dao_wallet").value;
            dao.registrationDate = 0;
            dao.registrationId = 0;

            console.log(dao);

            daoAtheneumContract.methods.registerDAO(dao).send({
                    from: account
                })
                .then(function(response) {
                    console.log(response);
                    ge("show_register_message").innerHTML = response;
                    clearFields();
                })
                .catch(function(err) {
                    console.log(err);
                })
        }

        function clearFields() {
            ge("dao_name").value = "";
            ge("dao_type").value = "";
            ge("dao_short_description").value = "";
            ge("dao_detailed_description").value = "";
            ge("member_access_type").value = "";
            ge("access_contract").value = "";
            ge("paid_media_price").value = "";
            ge("paid_media_currency").value = "";
            ge("dao_wallet").value = "";
        }

        function findDAO() {
            var daoName = ge("find_dao_field").value;
            daoAtheneumContract.methods.findDAO(daoName).call({
                    from: account
                })
                .then(function(response) {
                    console.log(response);
                    displayDAOSearchResults(response);
                })
                .catch(function(err) {
                    console.log(err);

                });
        }

        function displayDAOSearchResults(dao) {
            var body = ge("dao_results");
            var row = ce("tr");

            var name = ce("td").append(text(dao.name));
            var desc = ce("td").append(text(dao.shortDescription));
            var count = ce("td").append(text(dao.name));
            var price = ce("td").append(text(dao.paidMediaPrice));

            row.append(name);
            row.append(desc);
            row.append(count);
            row.append(price);

            body.append(row);
        }

        function ge(element) {
            return document.getElementById(element);
        }

        function ce(element) {
            return document.createElement(element);
        }

        function text(txt) {
            return document.createTextNode(txt);
        }
    </script>
</body>

</html>
<!-- end document-->